# Runner - Managing flows programmatically

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! Instead, edit the notebook w/the location & name as this file. -->

The `Runner` class and its notebook-focused counterpart `NBRunner` allow you to start runs and perform other operations programmatically. For an overview, see [Managing Flows in Notebooks and Scripts](/metaflow/managing-flows/introduction).

## Runner

The `Runner` object is typically used as a context manager:
```python
with Runner(...) as runner:
    ...
```
note that `ExecutingRun` returned by `run` and `async_run` works as a context manager as well, so you can do
```python
with Runner(...).run() as running:
   ...
```
or 
```python
with await Runner(...).async_run() as running:
    ...
```
If you don't use `Runner` as a context manager, remember to call `Runner.cleanup()` to remove any leftover temp files.


<DocSection type="class" name="Runner" module="metaflow" show_import="False" heading_level="3" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/metaflow_runner.py#L199">
<SigArgSection>
<SigArg name="flow_file, show_output=True, profile=None, env=None, cwd=None, **kwargs" />
</SigArgSection>
<Description summary="Metaflow's Runner API that presents a programmatic interface\nto run flows and perform other operations either synchronously or asynchronously.\nThe class expects a path to the flow file along with optional arguments\nthat match top-level options on the command-line." extended_summary="This class works as a context manager, calling `cleanup()` to remove\ntemporary files at exit.\n\nExample:\n```python\nwith Runner('slowflow.py', pylint=False) as runner:\n    result = runner.run(alpha=5, tags=[&#34;abc&#34;, &#34;def&#34;], max_workers=5)\n    print(result.run.finished)\n```" />
<ParamSection name="Parameters">
	<Parameter name="flow_file" type="str" desc="Path to the flow file to run" />
	<Parameter name="show_output" type="bool, default True" desc="Show the 'stdout' and 'stderr' to the console by default,\nOnly applicable for synchronous 'run' and 'resume' functions." />
	<Parameter name="profile" type="Optional[str], default None" desc="Metaflow profile to use to run this run. If not specified, the default\nprofile is used (or the one already set using `METAFLOW_PROFILE`)" />
	<Parameter name="env" type="Optional[Dict], default None" desc="Additional environment variables to set for the Run. This overrides the\nenvironment set for this process." />
	<Parameter name="cwd" type="Optional[str], default None" desc="The directory to run the subprocess in; if not specified, the current\ndirectory is used." />
	<Parameter name="**kwargs" type="Any" desc="Additional arguments that you would pass to `python myflow.py` before\nthe `run` command." />
</ParamSection>
</DocSection>



<DocSection type="method" name="Runner.cleanup" module="metaflow" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/metaflow_runner.py#L448">
<SigArgSection>
<SigArg name="self" />
</SigArgSection>
<Description summary="Delete any temporary files created during execution." />

</DocSection>


### Blocking API

These calls block until the command completes.


<DocSection type="method" name="Runner.run" module="metaflow" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/metaflow_runner.py#L304">
<SigArgSection>
<SigArg name="self" /><SigArg name="**kwargs" />
</SigArgSection>
<Description summary="Blocking execution of the run. This method will wait until\nthe run has completed execution." />
<ParamSection name="Parameters">
	<Parameter name="**kwargs" type="Any" desc="Additional arguments that you would pass to `python myflow.py` after\nthe `run` command, in particular, any parameters accepted by the flow." />
</ParamSection>
<ParamSection name="Returns">
	<Parameter type="ExecutingRun" desc="ExecutingRun containing the results of the run." />
</ParamSection>
</DocSection>



<DocSection type="method" name="Runner.resume" module="metaflow" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/metaflow_runner.py#L338">
<SigArgSection>
<SigArg name="self" /><SigArg name="**kwargs" />
</SigArgSection>
<Description summary="Blocking resume execution of the run.\nThis method will wait until the resumed run has completed execution." />
<ParamSection name="Parameters">
	<Parameter name="**kwargs" type="Any" desc="Additional arguments that you would pass to `python ./myflow.py` after\nthe `resume` command." />
</ParamSection>
<ParamSection name="Returns">
	<Parameter type="ExecutingRun" desc="ExecutingRun containing the results of the resumed run." />
</ParamSection>
</DocSection>


### Non-Blocking API


<DocSection type="method" name="Runner.async_run" module="metaflow" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/metaflow_runner.py#L372">
<SigArgSection>
<SigArg name="self" /><SigArg name="**kwargs" />
</SigArgSection>
<Description summary="Non-blocking execution of the run. This method will return as soon as the\nrun has launched." extended_summary="Note that this method is asynchronous and needs to be `await`ed." />
<ParamSection name="Parameters">
	<Parameter name="**kwargs" type="Any" desc="Additional arguments that you would pass to `python myflow.py` after\nthe `run` command, in particular, any parameters accepted by the flow." />
</ParamSection>
<ParamSection name="Returns">
	<Parameter type="ExecutingRun" desc="ExecutingRun representing the run that was started." />
</ParamSection>
</DocSection>



<DocSection type="method" name="Runner.async_resume" module="metaflow" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/metaflow_runner.py#L407">
<SigArgSection>
<SigArg name="self" /><SigArg name="**kwargs" />
</SigArgSection>
<Description summary="Non-blocking resume execution of the run.\nThis method will return as soon as the resume has launched." extended_summary="Note that this method is asynchronous and needs to be `await`ed." />
<ParamSection name="Parameters">
	<Parameter name="**kwargs" type="Any" desc="Additional arguments that you would pass to `python myflow.py` after\nthe `resume` command." />
</ParamSection>
<ParamSection name="Returns">
	<Parameter type="ExecutingRun" desc="ExecutingRun representing the resumed run that was started." />
</ParamSection>
</DocSection>


## NBRunner

`NBRunner` is a wrapper over `Runner` which allows you to refer to a flow defined in a notebook cell instead of a file. For examples, see [Running flows in a notebook](/metaflow/managing-flows/notebook-runs).


<DocSection type="class" name="NBRunner" module="metaflow" show_import="False" heading_level="3" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/nbrun.py#L43">
<SigArgSection>
<SigArg name="flow, show_output=True, profile=None, env=None, base_dir=None, **kwargs" />
</SigArgSection>
<Description summary="A  wrapper over `Runner` for executing flows defined in a Jupyter\nnotebook cell." extended_summary="Instantiate this class on the last line of a notebook cell where\na `flow` is defined. In contrast to `Runner`, this class is not\nmeant to be used a context manager. Instead, use a blocking helper\nfunction like `nbrun` (which calls `cleanup()` internally) or call\n`cleanup()` explictly when using non-blocking APIs.\n\n```python\nrun = NBRunner(FlowName).nbrun()\n```" />
<ParamSection name="Parameters">
	<Parameter name="flow" type="FlowSpec" desc="Flow defined in the same cell" />
	<Parameter name="show_output" type="bool, default True" desc="Show the 'stdout' and 'stderr' to the console by default,\nOnly applicable for synchronous 'run' and 'resume' functions." />
	<Parameter name="profile" type="Optional[str], default None" desc="Metaflow profile to use to run this run. If not specified, the default\nprofile is used (or the one already set using `METAFLOW_PROFILE`)" />
	<Parameter name="env" type="Optional[Dict], default None" desc="Additional environment variables to set for the Run. This overrides the\nenvironment set for this process." />
	<Parameter name="base_dir" type="Optional[str], default None" desc="The directory to run the subprocess in; if not specified, a temporary\ndirectory is used." />
	<Parameter name="**kwargs" type="Any" desc="Additional arguments that you would pass to `python myflow.py` before\nthe `run` command." />
</ParamSection>
</DocSection>


### Blocking API


<DocSection type="method" name="NBRunner.nbrun" module="metaflow" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/nbrun.py#L134">
<SigArgSection>
<SigArg name="self" /><SigArg name="**kwargs" />
</SigArgSection>
<Description summary="Blocking execution of the run. This method will wait until\nthe run has completed execution." extended_summary="Note that in contrast to `run`, this method returns a\n`metaflow.Run` object directly and calls `cleanup()` internally\nto support a common notebook pattern of executing a flow and\nretrieving its results immediately." />
<ParamSection name="Parameters">
	<Parameter name="**kwargs" type="Any" desc="Additional arguments that you would pass to `python myflow.py` after\nthe `run` command, in particular, any parameters accepted by the flow." />
</ParamSection>
<ParamSection name="Returns">
	<Parameter type="Run" desc="A `metaflow.Run` object representing the finished run." />
</ParamSection>
</DocSection>



<DocSection type="method" name="NBRunner.nbresume" module="metaflow" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/nbrun.py#L159">
<SigArgSection>
<SigArg name="self" /><SigArg name="**kwargs" />
</SigArgSection>
<Description summary="Blocking resuming of a run. This method will wait until\nthe resumed run has completed execution." extended_summary="Note that in contrast to `resume`, this method returns a\n`metaflow.Run` object directly and calls `cleanup()` internally\nto support a common notebook pattern of executing a flow and\nretrieving its results immediately." />
<ParamSection name="Parameters">
	<Parameter name="**kwargs" type="Any" desc="Additional arguments that you would pass to `python myflow.py` after\nthe `resume` command." />
</ParamSection>
<ParamSection name="Returns">
	<Parameter type="Run" desc="A `metaflow.Run` object representing the resumed run." />
</ParamSection>
</DocSection>


### Non-Blocking API


<DocSection type="method" name="NBRunner.async_run" module="metaflow" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/nbrun.py#L197">
<SigArgSection>
<SigArg name="self" /><SigArg name="**kwargs" />
</SigArgSection>
<Description summary="Non-blocking execution of the run. This method will return as soon as the\nrun has launched. This method is equivalent to `Runner.async_run`." extended_summary="Note that this method is asynchronous and needs to be `await`ed." />
<ParamSection name="Parameters">
	<Parameter name="**kwargs" type="Any" desc="Additional arguments that you would pass to `python myflow.py` after\nthe `run` command, in particular, any parameters accepted by the flow." />
</ParamSection>
<ParamSection name="Returns">
	<Parameter type="ExecutingRun" desc="ExecutingRun representing the run that was started." />
</ParamSection>
</DocSection>



<DocSection type="method" name="NBRunner.async_resume" module="metaflow" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/nbrun.py#L218">
<SigArgSection>
<SigArg name="self" /><SigArg name="**kwargs" />
</SigArgSection>
<Description summary="Non-blocking execution of the run. This method will return as soon as the\nrun has launched. This method is equivalent to `Runner.async_resume`." extended_summary="Note that this method is asynchronous and needs to be `await`ed." />
<ParamSection name="Parameters">
	<Parameter name="**kwargs" type="Any" desc="Additional arguments that you would pass to `python myflow.py` after\nthe `run` command, in particular, any parameters accepted by the flow." />
</ParamSection>
<ParamSection name="Returns">
	<Parameter type="ExecutingRun" desc="ExecutingRun representing the run that was started." />
</ParamSection>
</DocSection>



<DocSection type="method" name="NBRunner.cleanup" module="metaflow" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/nbrun.py#L238">
<SigArgSection>
<SigArg name="self" />
</SigArgSection>
<Description summary="Delete any temporary files created during execution." extended_summary="Call this method after using `async_run` or `async_resume`. You don't\nhave to call this after `nbrun` or `nbresume`." />

</DocSection>


## ExecutingRun


<DocSection type="class" name="ExecutingRun" module="metaflow" show_import="False" heading_level="3" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/metaflow_runner.py#L31">
<SigArgSection>
<SigArg name="" />
</SigArgSection>
<Description summary="This class contains a reference to a `metaflow.Run` object representing\nthe currently executing or finished run, as well as metadata related\nto the process." extended_summary="`ExecutingRun` is returned by methods in `Runner` and `NBRunner`. It is not\nmeant to be instantiated directly.\n\nThis class works as a context manager, allowing you to use a pattern like\n```python\nwith Runner(...).run() as running:\n    ...\n```\nNote that you should use either this object as the context manager or \n`Runner`, not both in a nested manner." />

</DocSection>



<DocSection type="property" name="ExecutingRun.returncode" module="metaflow.runner.metaflow_runner" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/">

<Description summary="Gets the return code of the underlying subprocess. A non-zero\ncode indicates a failure, `None` a currently executing run.\n" />
<ParamSection name="Returns">
<Parameter type="Optional[int]" desc="The return code of the underlying subprocess." />
</ParamSection>
</DocSection>



<DocSection type="property" name="ExecutingRun.status" module="metaflow.runner.metaflow_runner" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/">

<Description summary="Returns the status of the underlying subprocess that is responsible\nfor executing the run.\n\nThe return value is one of the following strings:\n- `running` indicates a currently executing run.\n- `failed` indicates a failed run.\n- `successful` a successful run.\n" />
<ParamSection name="Returns">
<Parameter type="str" desc="The current status of the run." />
</ParamSection>
</DocSection>



<DocSection type="property" name="ExecutingRun.stdout" module="metaflow.runner.metaflow_runner" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/">

<Description summary="Returns the current stdout of the run. If the run is finished, this will\ncontain the entire stdout output. Otherwise, it will contain the\nstdout up until this point.\n" />
<ParamSection name="Returns">
<Parameter type="str" desc="The current snapshot of stdout." />
</ParamSection>
</DocSection>



<DocSection type="property" name="ExecutingRun.stderr" module="metaflow.runner.metaflow_runner" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/">

<Description summary="Returns the current stderr of the run. If the run is finished, this will\ncontain the entire stderr output. Otherwise, it will contain the\nstderr up until this point.\n" />
<ParamSection name="Returns">
<Parameter type="str" desc="The current snapshot of stderr." />
</ParamSection>
</DocSection>


### Non-Blocking API


<DocSection type="method" name="ExecutingRun.wait" module="metaflow" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/metaflow_runner.py#L75">
<SigArgSection>
<SigArg name="self" /><SigArg name="timeout" type="Optional" default="None" /><SigArg name="stream" type="Optional" default="None" />
</SigArgSection>
<Description summary="Wait for this run to finish, optionally with a timeout\nand optionally streaming its output." extended_summary="Note that this method is asynchronous and needs to be `await`ed." />
<ParamSection name="Parameters">
	<Parameter name="timeout" type="Optional[float], default None" desc="The maximum time to wait for the run to finish.\nIf the timeout is reached, the run is terminated" />
	<Parameter name="stream" type="Optional[str], default None" desc="If specified, the specified stream is printed to stdout. `stream` can\nbe one of `stdout` or `stderr`." />
</ParamSection>
<ParamSection name="Returns">
	<Parameter type="ExecutingRun" desc="This object, allowing you to chain calls." />
</ParamSection>
</DocSection>



<DocSection type="method" name="ExecutingRun.stream_log" module="metaflow" show_import="False" heading_level="4" link="https://github.com/Netflix/metaflow/tree/master/metaflow/runner/metaflow_runner.py#L171">
<SigArgSection>
<SigArg name="self" /><SigArg name="stream" type="str" /><SigArg name="position" type="Optional" default="None" />
</SigArgSection>
<Description summary="Asynchronous iterator to stream logs from the subprocess line by line." extended_summary="Note that this method is asynchronous and needs to be `await`ed." />
<ParamSection name="Parameters">
	<Parameter name="stream" type="str" desc="The stream to stream logs from. Can be one of `stdout` or `stderr`." />
	<Parameter name="position" type="Optional[int], default None" desc="The position in the log file to start streaming from. If None, it starts\nfrom the beginning of the log file. This allows resuming streaming from\na previously known position" />
</ParamSection>
<ParamSection name="Yields">
	<Parameter type="Tuple[int, str]" desc="A tuple containing the position in the log file and the line read. The\nposition returned can be used to feed into another `stream_logs` call\nfor example." />
</ParamSection>
</DocSection>

